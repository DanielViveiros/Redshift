{"entities":[{"fqn":"/Community Queries","id":"067ce53b-d1d2-431a-9f3d-4765eb18eebf","parent_folder_id":"bb6de4af-1aad-493e-a9ee-b3e75cf58ed7","name":"Community Queries","entity_type":"FOLDER"},{"fqn":"/Community Queries/Redshift/Administrative Queries","id":"b1dab408-6e1f-4303-aa9b-cb45f1a37eff","parent_folder_id":"f817d4fd-5d49-4647-a6af-6c4c1481ecc7","name":"Administrative Queries","entity_type":"FOLDER"},{"fqn":"/Community Queries/Redshift/Administrative Queries/Distribution and skew for all tables in database","id":"cf871d90-a2f3-4bfa-bd35-b18976d6a3ed","parent_folder_id":"b1dab408-6e1f-4303-aa9b-cb45f1a37eff","name":"Distribution and skew for all tables in database","entity_type":"SQL_ENTITY","description":"Shows information about distribution and skew for all tables in database","content":"select \r\n\ttable_id tableid,\r\n\t\"database\"||'.'||\"schema\"||'.'||\"table\" as object_name,\r\n\tsize size_mb,\r\n\t\"diststyle\" as diststyle_,\r\n\tsortkey1 as sortkey_,\r\n\tround(100*cast(max_blocks_per_slice - min_blocks_per_slice as float) / greatest(nvl (min_blocks_per_slice,0)::int,1),2) ratio_skew_across_slices,\r\n\tround(cast(100*dist_slice as float) /(select count(distinct slice) from stv_slices),2) pct_slices_populated\r\nfrom svv_table_info ti\r\ninner join (\r\n\t\tselect tbl,\r\n               min(c) min_blocks_per_slice,\r\n               max(c) max_blocks_per_slice,\r\n               count(distinct slice) dist_slice\r\n        from (select b.tbl,\r\n                     b.slice,\r\n                     count(*) as c\r\n              from stv_blocklist b\r\n              group by b.tbl, b.slice) r\r\n        where tbl in (select table_id from svv_table_info)\r\n        group by tbl\r\n) iq on iq.tbl = ti.table_id","type":"QUERY","platform":"Snowflake","executed_count":0},{"fqn":"/Community Queries/Redshift/Administrative Queries/Distribution and skew for the table","id":"f3bf9a04-c003-4e4a-ab01-a3ceb5e32e06","parent_folder_id":"b1dab408-6e1f-4303-aa9b-cb45f1a37eff","name":"Distribution and skew for the table","entity_type":"SQL_ENTITY","description":"Shows information about distribution and skew for the particular table","content":"select \r\n\ttable_id tableid,\r\n\t\"database\"||'.'||\"schema\"||'.'||\"table\" as object_name,\r\n\tsize size_mb,\r\n\t\"diststyle\" as diststyle_,\r\n\tsortkey1 as sortkey_,\r\n\tround(100*cast(max_blocks_per_slice - min_blocks_per_slice as float) / greatest(nvl (min_blocks_per_slice,0)::int,1),2) ratio_skew_across_slices,\r\n\tround(cast(100*dist_slice as float) /(select count(distinct slice) from stv_slices),2) pct_slices_populated\r\nfrom svv_table_info ti\r\ninner join (\r\n\t\tselect tbl,\r\n               min(c) min_blocks_per_slice,\r\n               max(c) max_blocks_per_slice,\r\n               count(distinct slice) dist_slice\r\n        from (select b.tbl,\r\n                     b.slice,\r\n                     count(*) as c\r\n              from stv_blocklist b\r\n              group by b.tbl, b.slice) r\r\n        where tbl in (select table_id from svv_table_info)\r\n        group by tbl\r\n) iq on iq.tbl = ti.table_id\r\nwhere lower(\"schema\") = lower('' ||$SCHEMA_NAME|| '') and lower(\"table\") = lower(''||$TABLE_NAME||'')","type":"QUERY","platform":"Snowflake","executed_count":0},{"fqn":"/Community Queries/Redshift","id":"f817d4fd-5d49-4647-a6af-6c4c1481ecc7","parent_folder_id":"067ce53b-d1d2-431a-9f3d-4765eb18eebf","name":"Redshift","entity_type":"FOLDER"}]}